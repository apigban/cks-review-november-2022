# trivy
    # I want to check vulnerabilities for running kube-apiserver
kubectl get --namespace=kube-system pod kube-apiserver-cks-master -oyaml  | grep image

    # use docker to lauch a container, trivy that provides an output of all vulnerabilities
docker run aquasec/trivy image k8s.gcr.io/kube-apiserver:v1.24.3

    # show only CRITICAL vulnerabilities
docker run aquasec/trivy image k8s.gcr.io/kube-apiserver:v1.13.1 --severity CRITICAL

    # show output in stdout as JSON
docker run aquasec/trivy image k8s.gcr.io/kube-apiserver:v1.13.1 --severity CRITICAL --format json

    # render output as a file on pwd
docker run aquasec/trivy image k8s.gcr.io/kube-apiserver:v1.13.1 --severity CRITICAL --format json --output results.json

    # trivy installed on host
#for image in `kubectl describe pod -n kube-system |grep "Image:" |awk '{print $2}'`; do trivy image --severity HIGH,CRITICAL $image; done